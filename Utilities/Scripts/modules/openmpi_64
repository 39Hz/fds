#%Module@VER@#####################################################################

proc ModulesHelp { } {
    global helpmsg
    puts stderr "\t$helpmsg\n"
}

#module add library/gmp6.0.0a library/mpfr3.1.2  library/mpc1.0.3 compilers/gcc4.9.2

#
# 1. change 'mpihome' to base directory: /usr/local/XXX/XXX/XXX,
#    and all variables below will be set correctly
#
set mpihome /shared/openmpi_64
setenv MPIDIST /shared/openmpi_64
setenv OPENMPI_MODULE eth

#
# 2. If this MPI is built w/ a commercial compiler, or a different
#    version of GNU compilers, load that module here so that it will
#    load when the module is loaded. Comment this line out if it 
#    isn't needed.
#
module load intel17



if [ file isdirectory $mpihome/bin ] {
    module-whatis "Sets up your mpi environment to use $mpihome"
    set helpmsg "Sets up your MPI environment to use $mpihome"
    # bring in new version
    setenv MPIHOME $mpihome
    setenv CC $mpihome/bin/mpicc
    setenv FC $mpihome/bin/mpif77
    setenv F90 $mpihome/bin/mpif90
    setenv F77 $mpihome/bin/mpif77
    setenv FDSNETWORK infiniband
    #setenv CPP $mpihome/bin/
    #setenv CXX $mpihome/bin/pgcpp
    prepend-path PATH $mpihome/bin
    prepend-path MANPATH $mpihome/man
    prepend-path C_INCLUDE_PATH $mpihome/include 
    prepend-path CPLUS_INCLUDE_PATH $mpihome/include 
    if [ file isdirectory $mpihome/lib64 ] {
	prepend-path LD_LIBRARY_PATH $mpihome/lib64:$mpihome/lib
    } else {
	prepend-path LD_LIBRARY_PATH $mpihome/lib
    }
} else {
    module-whatis "MPI $mpihome is NOT installed"
    set helpmsg "MPI $mpihome is NOT installed"
}

